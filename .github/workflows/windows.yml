name: Windows
'on':
  pull_request: null
  workflow_dispatch:
    inputs:
      myCommit:
        description: Commit SHA1
        required: false
        default: ''
        type: string
  push: null
  release:
    types:
      - published
jobs:
  build_windows:
    runs-on: windows-2022
    strategy:
      fail-fast: false
      matrix:
        configuration:
          - Debug
          - Release
        architecture:
          - x86
          - x64
    steps:
    - name: Checkout
      uses: actions/checkout@v3
      with:
        submodules: 'recursive'
        ref: ${{ inputs.myCommit }}
    - name: update ccache
      run: |
        choco upgrade ccache        
    - name: ccache
      uses: botanicvelious/ccache-action@v1.2.10
      with:
        key: windows-${{ matrix.configuration }}-${{ matrix.architecture }}
    - name: Configure
      run: |
        cmake -B build -G "Ninja" -DCMAKE_BUILD_TYPE=${{ matrix.configuration }} -DENABLE_TESTS=On
    - name: Build
      working-directory: build
      shell: cmd
      run: |
        ninja
